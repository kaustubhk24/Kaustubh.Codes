"use strict";(self.webpackChunkkaustubh=self.webpackChunkkaustubh||[]).push([[87956],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=p(n),h=r,d=m["".concat(s,".").concat(h)]||m[h]||c[h]||a;return n?o.createElement(d,i(i({ref:t},u),{},{components:n})):o.createElement(d,i({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},53049:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var o=n(87462),r=(n(67294),n(3905));const a={title:"[Updated] Submit HTML Form To Google Sheet in 5 Steps",date:new Date("2021-03-06T09:20:10.000Z"),authors:"kaustubh",slug:"/submit-html-form-to-google-sheet-in-5-steps/"},i=void 0,l={permalink:"/blog/submit-html-form-to-google-sheet-in-5-steps/",source:"@site/blog/2021-03-06-submit-html-form-to-google-sheet-in-5-steps.md",title:"[Updated] Submit HTML Form To Google Sheet in 5 Steps",description:"Many times while working on static sites we need HTML forms to embeded on our site, We found several articles submitting HTML form to Google Sheets, but in 2021 all of them are out of date, this is latest method you should follow to Submit HTML Form To Google Sheet.",date:"2021-03-06T09:20:10.000Z",formattedDate:"March 6, 2021",tags:[],readingTime:4.47,hasTruncateMarker:!1,authors:[{name:"Kaustubh Kulkarni",title:"ServiceNow Developer",url:"https://github.com/kaustubhk24",imageURL:"https://www.gravatar.com/avatar/b76fcfc82fc2e8fdc8075636f1735f61?s=200",key:"kaustubh"}],frontMatter:{title:"[Updated] Submit HTML Form To Google Sheet in 5 Steps",date:"2021-03-06T09:20:10.000Z",authors:"kaustubh",slug:"/submit-html-form-to-google-sheet-in-5-steps/"},prevItem:{title:"Add FREE WhatsApp Floating Button on Your Website",permalink:"/blog/free-whatsapp-floating-button/"},nextItem:{title:"Weather Observation Station 1",permalink:"/blog/weather-observation-station-1/"}},s={authorsImageUrls:[void 0]},p=[{value:"Making  HTML Form",id:"making--html-form",level:2},{value:"Setting Up Google Sheet To Submit HTML",id:"setting-up-google-sheet-to-submit-html",level:2},{value:"Creating File To Submit Data",id:"creating-file-to-submit-data",level:2},{value:"Video",id:"video",level:2},{value:"Download Complete Project",id:"download-complete-project",level:2}],u={toc:p},m="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Many times while working on static sites we need HTML forms to embeded on our site, We found several articles submitting HTML form to Google Sheets, but in 2021 all of them are out of date, this is latest method you should follow to Submit HTML Form To Google Sheet."),(0,r.kt)("h2",{id:"making--html-form"},"Making  HTML Form"),(0,r.kt)("p",null,"First you should have HTML form with you, if you don't have any form now, then for example you can freely copy paste our form, see example ",(0,r.kt)("strong",{parentName:"p"},"Registration-file.html")," form."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="Registration-file.html"',title:'"Registration-file.html"'},'<!DOCTYPE html>\n<html>\n<head>\n    <title> Registration Form</title>\n</head>\n<body>\n    <h1 align="center">  Registration form</h1>\n    <form target="_blank" action="save-on-drive.html" method="GET">\n        <table align="center" title="User Registration form">\n            <tr>\n                <td>\n                      First Name\n                </td>\n                <td>\n                    <input type="text" name="FirstName" style="width: 200px" pattern="[A-Za-z]{3,10}">\n                </td>\n            </tr>\n             <tr>\n                <td>\n                     Last Name\n                </td>\n                <td>\n                    <input type="text" name="LastName" style="width: 200px" pattern="[A-Za-z]{3,10}">\n                </td>\n            </tr>\n             <tr>\n                <td>\n                     Email\n                </td>\n                <td>\n                    <input type="Email" name="Email" style="width: 200px">\n                </td>\n            </tr>\n             <tr>\n                <td>\n                    Mobile Number\n                </td>\n                <td>\n                    <input type="tel" name="MobileNo" style="width: 200px"  required >\n                </td>\n            </tr>\n            <tr></tr>\n            <tr>\n                <td  colspan="2">\n                    <input type="Submit" name="Submit" style="width: 200px">\n                </td>\n            </tr>\n        </table>\n    </form>\n</body>\n</html>\n')),(0,r.kt)("p",null,"While You create and complete form to Submit in Google Sheets,"),(0,r.kt)("p",null,"Make sure you have"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Used GET Method"),(0,r.kt)("li",{parentName:"ul"},"In Action you must have the exact path of save-on-drive.html file"),(0,r.kt)("li",{parentName:"ul"},"Use Target blank , if you want to submit form in another new tab, if not just remove the target attribute")),(0,r.kt)("h2",{id:"setting-up-google-sheet-to-submit-html"},"Setting Up Google Sheet To Submit HTML"),(0,r.kt)("p",null,"First create ",(0,r.kt)("a",{parentName:"p",href:"https://sheets.google.com"},"Google Sheet")," , if you don't have one."),(0,r.kt)("p",null,"Now let's link google form to sheet, So that we can submit HTML Form To Google Sheet."),(0,r.kt)("p",null,"Click on ",(0,r.kt)("strong",{parentName:"p"},"Script Editor"),", Now it will open editor in next screen,"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image.png",alt:"Submit HTML Form To Google Sheet"})," "),(0,r.kt)("p",null,"Now we will rename Our project , To rename just click on Untitled Project & in popup enter new project name and click ",(0,r.kt)("strong",{parentName:"p"},"rename.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image-1.png",alt:"Submit HTML Form To Google Sheet"})," "),(0,r.kt)("p",null,"Now remove firstly written function from there and copy paste code below there, and click on ",(0,r.kt)("strong",{parentName:"p"},"save button icon")," , Once saved we will move forward for ",(0,r.kt)("strong",{parentName:"p"},"initial setup"),", For initial setup,"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="function"',title:'"function"'},'function doGet(e){\n  return handleResponse(e);\n}\n//  Enter sheet name where data is to be written below\n        var SHEET_NAME = "Sheet1";\nvar SCRIPT_PROP = PropertiesService.getScriptProperties(); // new property service\nfunction handleResponse(e) {\n  // shortly after my original solution Google announced the LockService[1]\n  // this prevents concurrent access overwritting data\n  // [1] http://googleappsdeveloper.blogspot.co.uk/2011/10/concurrency-and-google-apps-script.html\n  // we want a public lock, one that locks for all invocations\n  var lock = LockService.getPublicLock();\n  lock.waitLock(30000);  // wait 30 seconds before conceding defeat.\n  try {\n    // next set where we write the data - you could write to multiple/alternate destinations\n    var doc = SpreadsheetApp.openById(SCRIPT_PROP.getProperty("key"));\n    var sheet = doc.getSheetByName(SHEET_NAME);\n    // we\'ll assume header is in row 1 but you can override with header_row in GET/POST data\n    var headRow = e.parameter.header_row || 1;\n    var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];\n    var nextRow = sheet.getLastRow()+1; // get next row\n    var row = [];\n    // loop through the header columns\n    for (i in headers){\n      if (headers[i] == "Timestamp"){ // special case if you include a \'Timestamp\' column\n        row.push(new Date());\n      } else { // else use header name to get data\n        row.push(e.parameter[headers[i]]);\n      }\n    }\n    // more efficient to set values as [][] array than individually\n    sheet.getRange(nextRow, 1, 1, row.length).setValues([row]);\n    // return json success results\n    return ContentService\n          .createTextOutput(JSON.stringify({"result":"success", "row": nextRow}))\n          .setMimeType(ContentService.MimeType.JSON);\n  } catch(e){\n    // if error return this\n    return ContentService\n          .createTextOutput(JSON.stringify({"result":"error", "error": e}))\n          .setMimeType(ContentService.MimeType.JSON);\n  } finally { //release lock\n    lock.releaseLock();\n  }\n}\nfunction setup() {\n    var doc = SpreadsheetApp.getActiveSpreadsheet();\n    SCRIPT_PROP.setProperty("key", doc.getId());\n}\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image-3.png",alt:"IMG",title:"IMG"})," "),(0,r.kt)("p",null,"Click on Setup Button to start setup"),(0,r.kt)("p",null,"Once you start setup it will show you message that ",(0,r.kt)("strong",{parentName:"p"},"Authorization Required"),", Now let's authorize it,"),(0,r.kt)("p",null,"It will ask you for some permissions , So simply ",(0,r.kt)("strong",{parentName:"p"},"allow")," all the permission , So that we can submit html form to google sheets,"),(0,r.kt)("p",null,"Next step will be deployment,\n",(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image-4.png",alt:"Submit HTML Form To Google Sheet"})," "),(0,r.kt)("p",null,"Click on ",(0,r.kt)("strong",{parentName:"p"},"Deploy")," button and Select option ",(0,r.kt)("strong",{parentName:"p"},"New deployment")),(0,r.kt)("p",null,"In Select Type select option ",(0,r.kt)("strong",{parentName:"p"},"Web app")," from list, this is last step on Google sheet site,\n",(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image-6-1024x731.png",alt:"Submit HTML Form To Google Sheet"})," "),(0,r.kt)("p",null,"In ",(0,r.kt)("strong",{parentName:"p"},"configuration")," in ",(0,r.kt)("strong",{parentName:"p"},"Description"),", enter description of project ( Not required ) , this is not compulsory"),(0,r.kt)("p",null,"In next box in ",(0,r.kt)("strong",{parentName:"p"},"Execute")," as box you will see ",(0,r.kt)("strong",{parentName:"p"},"your email")," , keep as it is,"),(0,r.kt)("p",null,"In last ",(0,r.kt)("strong",{parentName:"p"},"Who has access")," select option ",(0,r.kt)("strong",{parentName:"p"},"Anyone"),", & Click on Deploy\n",(0,r.kt)("img",{parentName:"p",src:"https://kaustubhk24.netlify.app/imgs/wp-content/uploads/2021/03/image-7-1024x730.png",alt:"Submit HTML Form To Google Sheet"})," "),(0,r.kt)("p",null,"From this window copy URL & keep it safe,"),(0,r.kt)("h2",{id:"creating-file-to-submit-data"},"Creating File To Submit Data"),(0,r.kt)("p",null,"In last step create file save-on-drive.html and just update url you copied from Google site, that's it, Your app is ready, You can use,"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="save-on-drive.html"',title:'"save-on-drive.html"'},'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta http-equiv="X-UA-Compatible" content="IE=edge">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Your Information has been Saved</title>\n</head>\n<script type="text/javascript">\nvar url_string = window.location.href;\nvar url = new URL(url_string);\nvar FirstName = url.searchParams.get("FirstName");\nvar LastName = url.searchParams.get("LastName");\nvar Email = url.searchParams.get("Email");\nvar MobileNo = url.searchParams.get("MobileNo");\nvar request = new XMLHttpRequest();\nrequest.onreadystatechange = function() {\n    if (this.readyState == 4 && this.status == 200) {\n        console.log(this.responseText);\n    }\n};\nvar final_url="https://script.google.com/macros/s/your-script-id/exec?FirstName=";\nfinal_url=final_url+FirstName+"&LastName="+LastName+"&Email="+Email+"&MobileNo="+MobileNo;\nrequest.open(\'GET\', final_url);\nrequest.send();\n<\/script>\n<body>\n <h1 id="confirmation"> Your Information has been saved</h1>\n<script type="text/javascript">\n<\/script>\n</body>\n</html\n')),(0,r.kt)("h2",{id:"video"},"Video"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.youtube.com/embed/ZldOKPSqZUM"},"Watch YouTube Video")),(0,r.kt)("h2",{id:"download-complete-project"},"Download Complete Project"),(0,r.kt)("p",null,"This project example is now available for free, Get it while it's free."),(0,r.kt)("p",null,"Download complete source code from link below"),(0,r.kt)("p",null," ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/JustInClicks-com/static-cdn/raw/main/Downloads/html/html-form-submit-google-sheet-exmple.rar"},"Download Source Code")))}c.isMDXComponent=!0}}]);